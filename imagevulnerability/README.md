# Image Vulnerability

## Overview

Image vulnerabilities refer to security weaknesses or flaws in the container images used to run workloads in Kubernetes. These vulnerabilities can come from the following user and system pitfalls.
- **Outdated base images** - e.g., old version of Ubuntu, Alpine with known CVEs that are no longer being supported/patched
- **Bundled software with known vulnerabilities** - e.g., an old version of OpenSSL or curl
- **Misconfigurations** - e.g., hardcoded secrets, excessive permissions, or unnecessary packages
- **Unverified sources** - e.g., using images from untrusted registries or sources

## How Image Vulnerabilities Can Be Exploited

Image vulnerabilities can be exploited in various ways, including:
- Privelege Escalation
  Vulnerable binaries inside the image can allow attackers to gain root access inside the container.
- Remote Code Execution (REC)
  If the image includes outdated libraries with RCE vulnerabilities, attackers can exploit them via exposed APIs or services.
- Supply Chain Attacks
  Malicious images or compromised dependencies can introduce backdoors.
- Persistence and Lateral Movement
  Attackers can use vulnerable images to pivot across pods or nodes, especially if combined with misconfigured RBAC or network policies.

## Justification for Regular Image Vulnerability Scanning and Updates

- Patch known CVEs: Most exploits target known vulnerabilities that have patches available
- Reduce attack surface: Removing unnecessary packages and updating libraries reduces the number of potential vulnerabilities
- Compliance: Adhering to security standards like CIS and NIST requires regularly scanning for image vulnerabilities and updates
- Prevent Zero-Day Amplification: Outdated images often lack mitigations for new kernel or library exploits

## Best Practices

It is best practice to integrate image vulnerability scanning into the CI/CD pipeline to catch vulnerabilities before deployment. Additionally, regularly updating base images and dependencies, using minimal and trusted base images, and employing runtime security tools can help mitigate risks associated with image vulnerabilities.

### Vulnerability Scanning Tools

## Resources
- Trivy
- Grype
- Anchore